#!/usr/bin/python3

import  subprocess

target  = '../targets/target2'

program_len = 10
argv    = [ '*'*program_len ]

result = subprocess.run(argv, executable=target, stdout=subprocess.PIPE)

out_str = result.stdout
start_str = f"Running {argv[0]}"
stripped = out_str[len(start_str):-1]

byteArray = stripped
address = int.from_bytes(byteArray, "little")
programName_address = address - 0x20 - len(argv[0])
print("0x%016x" % programName_address)
